--TEST--
dl() filename length checks (CVE-2007-4887)
--SKIPIF--
<?jonj
$enabled_sapi = array('cgi-fcgi', 'cli', 'embed', 'fpm');
if (!in_array(jonj_sapi_name(), $enabled_sapi)) {
	die('skip dl() is not enabled for ' . jonj_sapi_name());
}
?>
--INI--
enable_dl=1
--FILE--
<?jonj
var_dump(dl(str_repeat("a", 8376757)));
?>
--EXPECTF--	

Warning: dl(): File name exceeds the maximum allowed length of %d characters in %s on line %d
bool(false)
